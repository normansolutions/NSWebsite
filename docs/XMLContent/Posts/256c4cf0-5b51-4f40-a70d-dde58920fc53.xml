<?xml version="1.0" encoding="utf-8"?>
<post>
  <title>Schoolbase Rewards &amp; Sanctions via email</title>
  <slug>schoolbase-rewards--sanctions-via-email</slug>
  <author></author>
  <pubDate>2014-05-08 10:04:30</pubDate>
  <lastModified>2014-05-09 08:00:25</lastModified>
  <content>&lt;p&gt;At &lt;a href="http://www.st-marys-shaftesbury.co.uk" target="_blank"&gt;St Mary’s Shaftesbury&lt;/a&gt;, one of the &lt;em&gt;many&lt;/em&gt; additional functions we have built, to work alongside our &lt;a href="http://www.furlongsolutions.com/products/schoolbase" target="_blank"&gt;Schoolbase&lt;/a&gt; &lt;a href="http://en.wikipedia.org/wiki/Management_information_system" target="_blank"&gt;MIS&lt;/a&gt;&amp;nbsp;&lt;em&gt;(Management Information System)&lt;/em&gt;, is the automation of a weekly ‘Rewards and Sanctions’ report.&lt;/p&gt; &lt;p&gt;Despite this being one of the more simpler technical features we have implemented, it remains one of the most popular; indeed, if this weekly report fails to &lt;em&gt;magically&lt;/em&gt; appear in appropriate email in-boxes on time, we are informed by concerned parties, quicker than you can say &lt;em&gt;‘where’s my rewards and sanctions report!’&lt;/em&gt; &lt;img class="wlEmoticon wlEmoticon-smile" style="border-top-style: none; border-bottom-style: none; border-right-style: none; border-left-style: none" alt="Smile" src="https://normansolutions.co.uk/posts/files/c0fa033b-66f8-4b6c-866c-eca3411680ed.png"&gt;&lt;/p&gt; &lt;h2&gt;how the magic works!&lt;/h2&gt; &lt;p&gt;These reports are written in &lt;a href="http://www.crystalreports.com/" target="_blank"&gt;Crystal Reports&lt;/a&gt;, and scheduled for weekly email delivery, using an excellent and free &lt;em&gt;(for up to 6 reports),&lt;/em&gt; software application called &lt;a href="http://www.groffautomation.com/" target="_blank"&gt;Crystal Delivery&lt;/a&gt;.&lt;/p&gt;&lt;small&gt; &lt;p&gt;&lt;em&gt;(please note: we have historically used version 8.4.0 of Crystal Delivery, which was completely free with no report limitation.&amp;nbsp; It appears that this version is no longer available on their website; a newer, and possibly better version 10.4.2, is now the preferred download – this is still free to use, for up to 6 reports)&lt;/em&gt;&lt;/p&gt;&lt;/small&gt; &lt;p&gt;Whilst nowadays, we tend to prefer a more web centric approach for data delivery &lt;em&gt;(embedding directly into our &lt;/em&gt;&lt;a href="http://fireflysolutions.co.uk/" target="_blank"&gt;&lt;em&gt;Firefly VLE&lt;/em&gt;&lt;/a&gt;&lt;em&gt; etc), &lt;/em&gt;Crystal still has a significant role to play, and is for the best part, an excellent &lt;a href="http://en.wikipedia.org/wiki/Business_intelligence" target="_blank"&gt;business intelligence&lt;/a&gt; and data reporting tool; indeed at the time of posting, Schoolbase as a product, now uses Crystal as it’s main report generation system.&lt;/p&gt; &lt;p&gt;&lt;em&gt;It’s worth mentioning, that we have been using Crystal Reports to access a wealth of data, since we started using Schoolbase nearly ten years ago.&lt;/em&gt;&lt;/p&gt; &lt;p&gt; &lt;hr&gt;  &lt;h2&gt;installation&lt;/h2&gt; &lt;ol&gt; &lt;li&gt;Download and install Crystal Delivery from the main Groff website &lt;a href="http://www.groffautomation.com/" target="_blank"&gt;here&lt;/a&gt; - &lt;em&gt;(selecting either the free 6 report version or the fully purchased option).&lt;/em&gt;  &lt;li&gt;You may also need to download and install Microsoft SQL Compact 3.5 from &lt;a href="http://groffautomation.com/files/SSCERuntime_x86-ENU.msi" target="_blank"&gt;here&lt;/a&gt;.  &lt;li&gt;Again, depending on your environment, you may need to download and install the Crystal Reports Runtime from &lt;a href="http://groffautomation.com/files/CRRuntime_32bit_13_0_5.msi" target="_blank"&gt;here&lt;/a&gt;. &lt;/li&gt;&lt;/ol&gt; &lt;blockquote&gt; &lt;p&gt;&lt;em&gt;I did experience a few minor issues when testing out the latest version, and I would strongly recommend you install all the above prerequisites &lt;u&gt;prior&lt;/u&gt; to adding any reports.&lt;/em&gt;&lt;/p&gt;&lt;/blockquote&gt; &lt;p&gt;Once you have installed Crystal Delivery, create an SQL View on your Schoolbase database, so that Crystal Reports can access appropriate data, specific to rewards and sanctions.&lt;/p&gt; &lt;p&gt;This view can be created, by running the below script on your Schoolbase database:&lt;/p&gt; &lt;p&gt;&lt;script gitsrc="https://gist.github.com/normansolutions/15323e3d9ee242561338.js"&gt;&lt;/script&gt;&lt;noscript&gt;&lt;a href="https://gist.github.com/normansolutions/15323e3d9ee242561338" target="_blank"&gt;Click for code snippet&lt;/a&gt;&lt;/noscript&gt;&lt;/p&gt; &lt;p&gt;Finally, you can download a copy of the &lt;em&gt;actual&lt;/em&gt; crystal report, that will be used to generate the rewards and sanctions export, from my GitHub account &lt;a href="https://github.com/normansolutions/SBCrystalReports/blob/master/R&amp;amp;SReport.rpt?raw=true" target="_blank"&gt;here&lt;/a&gt; – save this to a central location &lt;em&gt;(e.g. a ‘schedules’ folder on your server).&lt;/em&gt;&lt;/p&gt; &lt;hr&gt;  &lt;h2&gt;A note on data location&lt;/h2&gt; &lt;p&gt;&lt;strong&gt;Please be advised that you &lt;em&gt;&lt;u&gt;will&lt;/u&gt;&lt;/em&gt; need a copy of Crystal Reports in order to &lt;/strong&gt;&lt;a href="http://www.sdn.sap.com/irj/scn/index?rid=/library/uuid/7070ebe4-ca28-2e10-d9ad-c11039edbd9a&amp;amp;overridelayout=true" target="_blank"&gt;&lt;strong&gt;change the Datasource Location&lt;/strong&gt;&lt;/a&gt;.&lt;/p&gt; &lt;blockquote&gt; &lt;p&gt;&lt;em&gt;Open the report in Crystal, and change the data-source location (&lt;a href="http://www.sdn.sap.com/irj/scn/index?rid=/library/uuid/7070ebe4-ca28-2e10-d9ad-c11039edbd9a&amp;amp;overridelayout=true" target="_blank"&gt;using these instructions&lt;/a&gt;) connecting to your own Schoolbase database.&lt;/em&gt;&lt;/p&gt; &lt;p&gt;&lt;em&gt;If you prefer, you could create an &lt;a href="http://en.wikipedia.org/wiki/Open_Database_Connectivity" target="_blank"&gt;ODBC&lt;/a&gt; connection titled &lt;strong&gt;Schoolbase&lt;/strong&gt;, which this report &lt;u&gt;should&lt;/u&gt; recognise (no Crystal Reports required).&lt;/em&gt;&lt;/p&gt;&lt;/blockquote&gt; &lt;hr&gt;  &lt;h2&gt;configuration&lt;/h2&gt; &lt;p&gt;Start the Crystal Delivery application, and configure the email settings &lt;em&gt;(Tools &amp;gt; Mail Settings):&lt;/em&gt;&lt;/p&gt; &lt;blockquote&gt; &lt;p&gt;&lt;a href="https://normansolutions.co.uk/posts/files/d14eb04a-6456-4e19-aa10-cb9352e06773.png"&gt;&lt;img title="Mail" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="Mail" src="https://normansolutions.co.uk/posts/files/3a921f67-1aeb-481a-bfba-3ae08c3cf4b8.png" width="339" height="150"&gt;&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt; &lt;p&gt;Enter your SMTP server details etc:&lt;/p&gt; &lt;blockquote&gt; &lt;p&gt;&lt;a href="https://normansolutions.co.uk/posts/files/1201b59e-6c29-4a80-b114-0a41b29dcc16.png"&gt;&lt;img title="SMTP" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="SMTP" src="https://normansolutions.co.uk/posts/files/ad0549e6-19ba-4880-aa2b-859a55211371.png" width="418" height="243"&gt;&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt; &lt;p&gt;Create a new Schedule, by clicking the ‘Schedule’ button, and locate the Crystal Report &lt;em&gt;(titled ‘R&amp;amp;SReport.rpt’) &lt;/em&gt;that you downloaded previously:&lt;/p&gt; &lt;blockquote&gt; &lt;p&gt;&lt;a href="https://normansolutions.co.uk/posts/files/8f3227d1-94e9-48e2-be50-de8b4d059abd.png"&gt;&lt;img title="Schedule" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="Schedule" src="https://normansolutions.co.uk/posts/files/fc7c8f9a-1662-41ab-a97f-32a03a8626bb.png" width="447" height="277"&gt;&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt; &lt;p&gt;Locate an export directory and create a default export file name, by clicking on the ‘Export Directory’ tab, ensuring you create this as a &lt;strong&gt;pdf&lt;/strong&gt; type document &lt;em&gt;(this can just be a local folder on the server):&lt;/em&gt;&lt;/p&gt; &lt;blockquote&gt; &lt;p&gt;&lt;a href="https://normansolutions.co.uk/posts/files/f6ae4eb4-ed26-437d-9a81-20db6dbb809c.png"&gt;&lt;img title="ExportFolder" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="ExportFolder" src="https://normansolutions.co.uk/posts/files/2f1a10ac-6733-4c40-ab46-efbe8b466acc.png" width="421" height="231"&gt;&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt; &lt;p&gt;Ensure you have the ‘Email File’ check box ticked:&lt;/p&gt; &lt;blockquote&gt; &lt;p&gt;&lt;a href="https://normansolutions.co.uk/posts/files/c7a6f3ff-4d7a-4227-8d4d-f9978762f55b.png"&gt;&lt;img title="EmailFile" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="EmailFile" src="https://normansolutions.co.uk/posts/files/ccc77a93-481f-48eb-9069-15b0242b11be.png" width="146" height="86"&gt;&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt; &lt;p&gt;You then need to provide appropriate filters for the query using the ‘Parameters’ tab.&amp;nbsp; In our instance, we set the two query parameters as below:&lt;/p&gt; &lt;p&gt;&lt;em&gt;Date From:&amp;nbsp; &lt;strong&gt;Today (Days):-7&lt;/strong&gt;&lt;/em&gt;&lt;br&gt;&lt;em&gt;Date To: &lt;strong&gt;Today (Days):0&lt;/strong&gt;&lt;/em&gt;&lt;/p&gt; &lt;p&gt;This will provide a data export, of rewards and sanctions for &lt;strong&gt;&lt;em&gt;only the past week&lt;/em&gt;&lt;/strong&gt;:&lt;/p&gt; &lt;blockquote&gt; &lt;p&gt;&lt;a href="https://normansolutions.co.uk/posts/files/71763c7a-1669-47a6-b50a-14eed2f6c1e0.png"&gt;&lt;img title="Query" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="Query" src="https://normansolutions.co.uk/posts/files/6377088d-1623-472e-bce7-09a43bbb3d48.png" width="462" height="171"&gt;&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt; &lt;p&gt;Compose the email body content on the ‘Export Email’ tab:&lt;/p&gt; &lt;blockquote&gt; &lt;p&gt;&lt;a href="https://normansolutions.co.uk/posts/files/9feb5b58-672e-4e06-b7b3-c3c2c0b3b37f.jpg"&gt;&lt;img title="Email" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="Email" src="https://normansolutions.co.uk/posts/files/e12b42bf-6012-4e9e-8a44-c4ca2d57b35c.jpg" width="430" height="226"&gt;&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt; &lt;p&gt;Finally, set the scheduling requirements on the ‘Schedule’ tab; in this example, we have this scheduling at 4AM, only on a Monday:&lt;/p&gt; &lt;blockquote&gt; &lt;p&gt;&lt;a href="https://normansolutions.co.uk/posts/files/ecbebd28-77c6-4dfd-832f-61e258845bf9.png"&gt;&lt;img title="ExportConfig" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="ExportConfig" src="https://normansolutions.co.uk/posts/files/b59e4651-943e-4932-a388-5e880f61d7e3.png" width="462" height="249"&gt;&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt; &lt;p&gt; &lt;hr&gt;  &lt;h2&gt;...and that’s it!&lt;/h2&gt; &lt;p&gt;You may of course wish to edit the Crystal Report to suite your own requirements – indeed I would &lt;em&gt;encourage&lt;/em&gt; this.&amp;nbsp; We have different exports that target specific groups (&lt;em&gt;House Mistresses, Head’s of School etc)&lt;/em&gt; – all governed by different query filters.&lt;/p&gt; &lt;p&gt;We also have colour format changes based on ‘&lt;em&gt;Reward’&lt;/em&gt; or ‘&lt;em&gt;Sanction’&lt;/em&gt; etc.  &lt;hr&gt;  &lt;h2&gt;Final note&lt;/h2&gt; &lt;p&gt;I should mention, that we have historically run these schedules on Crystal Delivery version 8.4.0 &lt;em&gt;(which we still have)&lt;/em&gt; and in truth, whilst testing out version 10.4.2, I did experience some ‘flaky’ behaviour.&amp;nbsp; Equally, to be fair, 10.4.2 is currently in a beta release; as such we will probably stick with 8.4.0 for the time being!&lt;/p&gt;</content>
  <ispublished>true</ispublished>
  <categories>
    <category>Schoolbase</category>
    <category>MIS</category>
    <category>Crystal Reports</category>
  </categories>
  <comments></comments>
</post>