<?xml version="1.0" encoding="utf-8"?>
<post>
  <title>Locked out user email notification</title>
  <slug>locked-out-user-email-notification</slug>
  <author></author>
  <pubDate>2015-06-20 15:11:29</pubDate>
  <lastModified>2015-06-20 15:11:29</lastModified>
  <content>&lt;p&gt;It recently occurred to me, that whilst my current full-time position is an IT Systems Manager, the majority of my blog posts thus far, have been more web centric – which is great, as I love the web and web technologies!&lt;/p&gt; &lt;p&gt;However, I felt in the interest of balance, I should introduce a few more tips and tricks that we use on a regular basis, in a more ‘operations’ capacity.&lt;/p&gt; &lt;blockquote&gt; &lt;p&gt;&lt;em&gt;This post is a &lt;strong&gt;QuickTip&lt;/strong&gt;, in the sense that it won’t digress into inner details, the whys and wherefores; designed to be quickly referenced.&lt;/em&gt;&lt;/p&gt;&lt;/blockquote&gt; &lt;hr&gt;  &lt;h2&gt;Problem&lt;/h2&gt; &lt;p&gt;You have an &lt;a href="https://technet.microsoft.com/en-us/library/hh994572(v=ws.10).aspx" target="_blank"&gt;Network Password Policy&lt;/a&gt; in place – you would like to be notified &lt;em&gt;(preferably by email)&lt;/em&gt; when an account is locked out.&lt;/p&gt; &lt;h2&gt;Solution&lt;/h2&gt; &lt;p&gt;In truth, there are numerous solutions on the internet about how to implement this functionality - this post is just how we do it.&lt;/p&gt; &lt;p&gt;Place a copy of the below PowerShell script in an appropriate folder on your Domain Controller &lt;em&gt;(configure relevant email variables in the script, accordingly).&lt;/em&gt;&lt;/p&gt; &lt;p&gt;&lt;script gitsrc="https://gist.github.com/normansolutions/7d245b25f86d6776c4f4.js"&gt;&lt;/script&gt;&lt;noscript&gt;&lt;a href="https://gist.github.com/7d245b25f86d6776c4f4"&gt;Click for code snippet&lt;/a&gt;&lt;/noscript&gt; &lt;/p&gt; &lt;p&gt;&lt;a href="https://technet.microsoft.com/en-us/library/cc766428.aspx" target="_blank"&gt;Schedule a task&lt;/a&gt; on your Domain Controller, to trigger whenever the event log receives a &lt;strong&gt;Security Log Event 4740.&lt;/strong&gt;&lt;/p&gt; &lt;p&gt;&lt;a href="https://normansolutions.co.uk/posts/files/458ccbea-34b5-4af6-9783-65df213bd415.jpg"&gt;&lt;img title="Trigger" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="Trigger" src="https://normansolutions.co.uk/posts/files/41f85934-54b2-4b7a-9c31-95c8a6730118.jpg" width="240" height="205"&gt;&lt;/a&gt;&lt;/p&gt; &lt;p&gt;Set the task scheduler action to &lt;strong&gt;Start a Program&lt;/strong&gt; &lt;em&gt;(path to the local PowerShell executable).&lt;/em&gt;&lt;/p&gt; &lt;p&gt;Pass in the the PowerShell script as an optional argument using the &lt;strong&gt;–file&lt;/strong&gt; switch.&lt;/p&gt; &lt;p&gt;(example: &lt;strong&gt;-file "\LockOutNotification.ps1")&lt;/strong&gt;&lt;/p&gt; &lt;p&gt;&lt;a href="https://normansolutions.co.uk/posts/files/76c31e7d-9abb-4bdf-8618-f92eb2a5e691.jpg"&gt;&lt;img title="Action" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="Action" src="https://normansolutions.co.uk/posts/files/b4154aed-7dfe-4f2b-8f6d-561f5062ed2c.jpg" width="227" height="244"&gt;&lt;/a&gt;&lt;/p&gt; &lt;p&gt; &lt;hr&gt;  &lt;h2&gt;That’s it!&lt;/h2&gt; &lt;p&gt;You should now receive an email notification each time a user account is locked out.&lt;/p&gt; &lt;p&gt;&lt;em&gt;(please note: as mentioned previously in this article, there a numerous posts on the internet about how to perform this functionality, and I would &lt;u&gt;not&lt;/u&gt; wish to claim any form of unique authorship of the procedure – this is just the method that we have implemented at &lt;a href="http://www.st-marys-shaftesbury.co.uk/" target="_blank"&gt;St Mary’s Shaftesbury&lt;/a&gt;)&lt;/em&gt;&lt;/p&gt;</content>
  <ispublished>true</ispublished>
  <categories>
    <category>DevOps</category>
    <category>PowerShell</category>
    <category>Script</category>
    <category>SysAdmin</category>
    <category>QuickTip</category>
  </categories>
  <comments></comments>
</post>